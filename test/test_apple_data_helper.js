/**
 * Created by ganesha on 6/19/17.
 */
'use strict';

let chai = require('chai');
let chaiAsPromised = require('chai-as-promised');
chai.use(chaiAsPromised);
let expect = chai.expect;

let AppleDataHelper = require('../apple_data_helper');
chai.config.includeStack = true;

describe('AppleDataHelper', function() {
    let subject = new AppleDataHelper();
    let category;
    let limit;

    describe('#getAppleData', function() {
        context('with a valid category and limit', function () {
            it('returns matching category data', function () {
                category = 'MOVIES';
                limit = 10;
                let value = subject.requestAppleData(category,limit).then(function (obj) {
                    return obj.feed.title.label;
                });
                return expect(value).to.eventually.eq('iTunes Store: Top Movies');
            });
            it('returns matching category data with size', function () {
                category = 'MOVIES';
                limit = 10;
                let value = subject.requestAppleData(category,limit).then(function (obj) {
                    return obj.feed.entry.length;
                });
                return expect(value).to.eventually.eq(10);
            });
        });
        context('with an invalid category code', function() {
            it('returns an error', function () {
                category = 'PUNKYBREWSTER';
                return expect(subject.requestAppleData(category)).to.be.rejectedWith(Error);
            });
        });//*/
    });
});

describe('#formatAppleData', function() {
    let subject = new AppleDataHelper();
    let data = {"feed":{"author":{"name":{"label":"iTunes Store"}, "uri":{"label":"http://www.apple.com/itunes/"}}, "entry":[
        {"im:name":{"label":"Beauty and the Beast (2017)"}, "rights":{"label":"© 2017 Disney Enterprises, Inc. All Rights Reserved."}, "im:image":[
            {"label":"http://is4.mzstatic.com/image/thumb/Video117/v4/44/20/26/44202630-a564-546f-1c45-573c38d185e3/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is4.mzstatic.com/image/thumb/Video117/v4/44/20/26/44202630-a564-546f-1c45-573c38d185e3/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is1.mzstatic.com/image/thumb/Video117/v4/44/20/26/44202630-a564-546f-1c45-573c38d185e3/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"The story and characters you know and love come to spectacular life in the live-action adaptation of Disney’s animated classic Beauty and the Beast, a cinematic event celebrating one of the most beloved tales ever told. Experience the fantastic journey of Belle, a bright, beautiful and independent young woman who is taken prisoner by a Beast in his castle. Despite her fears, she befriends the castle’s enchanted staff, and learns to look beyond the Beast’s hideous exterior and realize the kind heart of the true Prince within."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$19.99", "attributes":{"amount":"19.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Beauty and the Beast (2017) - Bill Condon"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/beauty-and-the-beast-2017/id1212678379?uo=2"}},
            {"im:duration":{"label":"145663.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video122/v4/d0/8c/b9/d08cb9b6-8706-a01e-c8ee-01b59c12c34f/mzvf_2772913553692589526.640x356.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/beauty-and-the-beast-2017/id1212678379?uo=2", "attributes":{"im:id":"1212678379"}}, "im:artist":{"label":"Bill Condon"}, "category":{"attributes":{"im:id":"4410", "term":"Kids & Family", "scheme":"https://itunes.apple.com/us/genre/movies-kids-family/id4410?uo=2", "label":"Kids & Family"}}, "im:releaseDate":{"label":"2017-03-17T00:00:00-07:00", "attributes":{"label":"March 17, 2017"}}},
        {"im:name":{"label":"John Wick: Chapter 2"}, "im:image":[
            {"label":"http://is4.mzstatic.com/image/thumb/Video52/v4/40/28/cc/4028cc6c-bd67-4629-92c1-288b6f392e2e/2550416223065.jpg/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is4.mzstatic.com/image/thumb/Video52/v4/40/28/cc/4028cc6c-bd67-4629-92c1-288b6f392e2e/2550416223065.jpg/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video52/v4/40/28/cc/4028cc6c-bd67-4629-92c1-288b6f392e2e/2550416223065.jpg/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"Legendary hitman John Wick is forced back out of retirement by a former associate plotting to seize control of a shadowy international assassins’ guild. Bound by a blood oath to help him, John travels to Rome where he squares off against some of the world’s deadliest killers."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$14.99", "attributes":{"amount":"14.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"John Wick: Chapter 2 - Chad Stahelski"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/john-wick-chapter-2/id1199661949?uo=2"}},
            {"im:duration":{"label":"106693.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video122/v4/72/7e/9f/727e9fa4-dfe9-afc5-3162-cac886d6ad16/mzvf_7369339614989072133.640x352.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/john-wick-chapter-2/id1199661949?uo=2", "attributes":{"im:id":"1199661949"}}, "im:artist":{"label":"Chad Stahelski"}, "category":{"attributes":{"im:id":"4401", "term":"Action & Adventure", "scheme":"https://itunes.apple.com/us/genre/movies-action-adventure/id4401?uo=2", "label":"Action & Adventure"}}, "im:releaseDate":{"label":"2017-02-10T00:00:00-07:00", "attributes":{"label":"February 10, 2017"}}},
        {"im:name":{"label":"The LEGO Batman Movie"}, "rights":{"label":"BATMAN and all related characters and elements © & ™ DC Comics. © 2017 The Lego Group. LEGO, the LEGO logo, the Minifigure and the Brick and Knob configurations are © & ™ of the LEGO Group. © 2017 Warner Bros. Entertainment Inc. and RatPac Entertainment, LLC."}, "im:image":[
            {"label":"http://is2.mzstatic.com/image/thumb/Video122/v4/60/02/00/6002008f-12d9-1223-fd35-2c8293fd1de7/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video122/v4/60/02/00/6002008f-12d9-1223-fd35-2c8293fd1de7/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is1.mzstatic.com/image/thumb/Video122/v4/60/02/00/6002008f-12d9-1223-fd35-2c8293fd1de7/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"In the irreverent spirit of fun that made “The LEGO® Movie” a worldwide phenomenon, the self-described leading man of that ensemble – LEGO Batman (Will Arnett) – stars in his own big-screen adventure. But there are big changes brewing in Gotham, and if he wants to save the city from The Joker’s (Zach Galifianakis) hostile takeover, Batman may have to drop the lone vigilante thing, try to work with others and maybe, just maybe, learn to lighten up."}, "im:rentalPrice":{"label":"$3.99", "attributes":{"amount":"3.99000", "currency":"USD"}}, "im:price":{"label":"$19.99", "attributes":{"amount":"19.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"The LEGO Batman Movie - Chris Mckay"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/the-lego-batman-movie/id1197505667?uo=2"}},
            {"im:duration":{"label":"146207.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video111/v4/42/22/05/42220514-eba9-d7de-181d-074c7b67ecb5/mzvf_2388615606531916430.640x356.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/the-lego-batman-movie/id1197505667?uo=2", "attributes":{"im:id":"1197505667"}}, "im:artist":{"label":"Chris Mckay"}, "category":{"attributes":{"im:id":"4410", "term":"Kids & Family", "scheme":"https://itunes.apple.com/us/genre/movies-kids-family/id4410?uo=2", "label":"Kids & Family"}}, "im:releaseDate":{"label":"2017-02-10T00:00:00-07:00", "attributes":{"label":"February 10, 2017"}}},
        {"im:name":{"label":"Hacksaw Ridge"}, "im:image":[
            {"label":"http://is3.mzstatic.com/image/thumb/Video122/v4/3c/83/eb/3c83eb4e-b1cc-7af5-22e4-60130fbc0089/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is3.mzstatic.com/image/thumb/Video122/v4/3c/83/eb/3c83eb4e-b1cc-7af5-22e4-60130fbc0089/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is3.mzstatic.com/image/thumb/Video122/v4/3c/83/eb/3c83eb4e-b1cc-7af5-22e4-60130fbc0089/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"HACKSAW RIDGE is the extraordinary true story of Desmond Doss [Andrew Garfield] who, in Okinawa during the bloodiest battle of WWII, saved 75 men without firing or carrying a gun. He was the only American soldier in WWII to fight on the front lines without a weapon, as he believed that while the war was justified, killing was nevertheless wrong. As an army medic, he single-handedly evacuated the wounded from behind enemy lines, braved fire while tending to soldiers and was wounded by a grenade and hit by snipers. Doss was the first conscientious objector awarded the Congressional Medal of Honor."}, "im:rentalPrice":{"label":"$0.99", "attributes":{"amount":"0.99000", "currency":"USD"}}, "im:price":{"label":"$9.99", "attributes":{"amount":"9.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Hacksaw Ridge - Mel Gibson"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/hacksaw-ridge/id1168450249?uo=2"}},
            {"im:duration":{"label":"92552.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video111/v4/55/9b/37/559b37cb-a6de-2dc8-3c6b-f6e3500a0bca/mzvf_9185103060951859863.640x352.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/hacksaw-ridge/id1168450249?uo=2", "attributes":{"im:id":"1168450249"}}, "im:artist":{"label":"Mel Gibson"}, "category":{"attributes":{"im:id":"4401", "term":"Action & Adventure", "scheme":"https://itunes.apple.com/us/genre/movies-action-adventure/id4401?uo=2", "label":"Action & Adventure"}}, "im:releaseDate":{"label":"2016-11-04T00:00:00-07:00", "attributes":{"label":"November 4, 2016"}}},
        {"im:name":{"label":"Table 19"}, "rights":{"label":"© 2017 Twentieth Century Fox Film Corporation. All rights reserved."}, "im:image":[
            {"label":"http://is5.mzstatic.com/image/thumb/Video82/v4/e1/6e/d8/e16ed8af-2331-2adf-3054-85e561853106/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is5.mzstatic.com/image/thumb/Video82/v4/e1/6e/d8/e16ed8af-2331-2adf-3054-85e561853106/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video82/v4/e1/6e/d8/e16ed8af-2331-2adf-3054-85e561853106/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"Relieved of her maid of honor duties after being dumped by the best man, Eloise (Anna Kendrick) decides to attend her oldest friend's wedding anyway and finds herself seated among a group of misfit strangers in the back of the ballroom. As secrets are revealed, Eloise bonds with her new tablemates and discovers that friendships—and even romance—can happen under the most unlikely circumstances."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$14.99", "attributes":{"amount":"14.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Table 19 - Jeffrey Blitz"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/table-19/id1209681677?uo=2"}},
            {"im:duration":{"label":"144078.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video111/v4/0f/5a/f2/0f5af257-d317-21e6-64db-9414237a0a6b/mzvf_4764158313710518126.640x356.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/table-19/id1209681677?uo=2", "attributes":{"im:id":"1209681677"}}, "im:artist":{"label":"Jeffrey Blitz"}, "category":{"attributes":{"im:id":"4404", "term":"Comedy", "scheme":"https://itunes.apple.com/us/genre/movies-comedy/id4404?uo=2", "label":"Comedy"}}, "im:releaseDate":{"label":"2017-03-03T00:00:00-07:00", "attributes":{"label":"March 3, 2017"}}},
        {"im:name":{"label":"Logan"}, "rights":{"label":"© 2017 Twentieth Century Fox Film Corporation. All rights reserved. MARVEL TM and 2017 MARVEL."}, "im:image":[
            {"label":"http://is2.mzstatic.com/image/thumb/Video117/v4/d1/69/35/d16935f1-38b1-eccd-e717-f8907ccb7afb/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video117/v4/d1/69/35/d16935f1-38b1-eccd-e717-f8907ccb7afb/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video117/v4/d1/69/35/d16935f1-38b1-eccd-e717-f8907ccb7afb/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"In the near future, a weary Logan cares for an ailing Professor X in a hide out on the Mexican border. But Logan's attempts to hide from the world and his legacy are up-ended when a young mutant arrives, being pursued by dark forces."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$14.99", "attributes":{"amount":"14.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Logan - James Mangold"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/logan/id1207483880?uo=2"}},
            {"im:duration":{"label":"107460.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video127/v4/8a/cb/f0/8acbf032-3f76-e48b-e9f2-aed1b8723c84/mzvf_8069304558932001664.640x356.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/logan/id1207483880?uo=2", "attributes":{"im:id":"1207483880"}}, "im:artist":{"label":"James Mangold"}, "category":{"attributes":{"im:id":"4401", "term":"Action & Adventure", "scheme":"https://itunes.apple.com/us/genre/movies-action-adventure/id4401?uo=2", "label":"Action & Adventure"}}, "im:releaseDate":{"label":"2017-03-03T00:00:00-07:00", "attributes":{"label":"March 3, 2017"}}},
        {"im:name":{"label":"Saban's Power Rangers"}, "im:price":{"label":"$14.99", "attributes":{"amount":"14.99000", "currency":"USD"}}, "im:image":[
            {"label":"http://is3.mzstatic.com/image/thumb/Video52/v4/00/c8/ec/00c8ece4-22d3-4021-a70b-04a0d89dda46/2620040224893.jpg/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is3.mzstatic.com/image/thumb/Video52/v4/00/c8/ec/00c8ece4-22d3-4021-a70b-04a0d89dda46/2620040224893.jpg/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is1.mzstatic.com/image/thumb/Video52/v4/00/c8/ec/00c8ece4-22d3-4021-a70b-04a0d89dda46/2620040224893.jpg/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"SABAN’S POWER RANGERS follows five ordinary teens who must become something extraordinary when they learn that their small town of Angel Grove — and the world — is on the verge of being obliterated by an alien threat. Chosen by destiny, our heroes quickly discover they are the only ones who can save the planet. But to do so, they will have to overcome their real-life issues and before it’s too late, band together as the Power Rangers."}, "im:artist":{"label":"Dean Israelite"}, "title":{"label":"Saban's Power Rangers - Dean Israelite"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/sabans-power-rangers/id1213572965?uo=2"}},
            {"im:duration":{"label":"96848.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video117/v4/00/72/ef/0072efe6-ee98-616b-8e2b-623d0e4fde2b/mzvf_4146248148826981136.640x352.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/sabans-power-rangers/id1213572965?uo=2", "attributes":{"im:id":"1213572965"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "category":{"attributes":{"im:id":"4401", "term":"Action & Adventure", "scheme":"https://itunes.apple.com/us/genre/movies-action-adventure/id4401?uo=2", "label":"Action & Adventure"}}, "im:releaseDate":{"label":"2017-03-24T00:00:00-07:00", "attributes":{"label":"March 24, 2017"}}},
        {"im:name":{"label":"Get Out"}, "rights":{"label":"© 2017 Universal Studios. All Rights Reserved."}, "im:image":[
            {"label":"http://is2.mzstatic.com/image/thumb/Video117/v4/69/4d/92/694d92a2-52f7-de90-e0e9-4eb6f4b3626f/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video117/v4/69/4d/92/694d92a2-52f7-de90-e0e9-4eb6f4b3626f/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is4.mzstatic.com/image/thumb/Video117/v4/69/4d/92/694d92a2-52f7-de90-e0e9-4eb6f4b3626f/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"Now that Chris (Daniel Kaluuya, Sicario) and his girlfriend, Rose (Allison Williams, Girls), have reached the meet-the-parents milestone of dating, she invites him for a weekend getaway in her parent’s home upstate. At first, Chris reads the family’s overly accommodating behavior as nervous attempts to deal with their daughter’s interracial relationship, but as the weekend progresses, a series of increasingly disturbing discoveries lead him to a truth that he could have never imagined."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$9.99", "attributes":{"amount":"9.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Get Out - Jordan Peele"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/get-out/id1202441786?uo=2"}},
            {"im:duration":{"label":"152413.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video111/v4/fe/76/8b/fe768b47-607b-f1bd-a5d9-d5b154edcc99/mzvf_2804406428561582836.640x352.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/get-out/id1202441786?uo=2", "attributes":{"im:id":"1202441786"}}, "im:artist":{"label":"Jordan Peele"}, "category":{"attributes":{"im:id":"4408", "term":"Horror", "scheme":"https://itunes.apple.com/us/genre/movies-horror/id4408?uo=2", "label":"Horror"}}, "im:releaseDate":{"label":"2017-02-24T00:00:00-07:00", "attributes":{"label":"February 24, 2017"}}},
        {"im:name":{"label":"Fist Fight"}, "rights":{"label":"© 2017 Warner Bros. Entertainment Inc., Village Roadshow Films North America Inc. and RatPac-Dune Entertainment LLC."}, "im:image":[
            {"label":"http://is2.mzstatic.com/image/thumb/Video122/v4/1d/b7/b4/1db7b438-e920-abcb-a455-ce6a444cc28d/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is2.mzstatic.com/image/thumb/Video122/v4/1d/b7/b4/1db7b438-e920-abcb-a455-ce6a444cc28d/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is1.mzstatic.com/image/thumb/Video122/v4/1d/b7/b4/1db7b438-e920-abcb-a455-ce6a444cc28d/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"Ice Cube and Charlie Day star as high school teachers prepared to solve their differences the hard way. On the last day of the year, mild-mannered high school English teacher Andy Campbell (Day) is trying his best to keep it together amidst senior pranks, a dysfunctional administration and budget cuts that put jobs on the line. But things go from bad to worse when he accidentally crosses his much tougher and deeply feared colleague, Ron Strickland (Ice Cube), who challenges Campbell to an old-fashioned throwdown after school. News of the fight spreads like wildfire and ends up becoming the very thing this school, and Campbell, needed."}, "im:rentalPrice":{"label":"$4.99", "attributes":{"amount":"4.99000", "currency":"USD"}}, "im:price":{"label":"$9.99", "attributes":{"amount":"9.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "title":{"label":"Fist Fight - Richie Keen"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/fist-fight/id1205789502?uo=2"}},
            {"im:duration":{"label":"103840.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video111/v4/f7/2f/ae/f72fae30-a688-b0b1-86d5-86ab092e7c77/mzvf_2571939125365856057.640x460.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/fist-fight/id1205789502?uo=2", "attributes":{"im:id":"1205789502"}}, "im:artist":{"label":"Richie Keen"}, "category":{"attributes":{"im:id":"4404", "term":"Comedy", "scheme":"https://itunes.apple.com/us/genre/movies-comedy/id4404?uo=2", "label":"Comedy"}}, "im:releaseDate":{"label":"2017-02-17T00:00:00-07:00", "attributes":{"label":"February 17, 2017"}}},
        {"im:name":{"label":"CHiPs (2017)"}, "im:image":[
            {"label":"http://is5.mzstatic.com/image/thumb/Video111/v4/17/58/3c/17583c61-5039-7d51-b76a-d0077e56716e/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is5.mzstatic.com/image/thumb/Video111/v4/17/58/3c/17583c61-5039-7d51-b76a-d0077e56716e/pr_source.lsr/60x60bb-85.jpg", "attributes":{"height":"60"}},
            {"label":"http://is1.mzstatic.com/image/thumb/Video111/v4/17/58/3c/17583c61-5039-7d51-b76a-d0077e56716e/pr_source.lsr/170x170bb-85.jpg", "attributes":{"height":"170"}}], "summary":{"label":"Jon Baker (Dax Shepard) and Frank “Ponch” Poncherello (Michael Peña) have just joined the California Highway Patrol (CHP) in Los Angeles but for very different reasons. Baker is a beaten-up pro motorbiker trying to put his life and marriage back together. Poncherello is a cocky undercover Federal agent investigating a multi-million dollar heist that may be an inside job — inside the CHP. The inexperienced rookie and hardened pro are teamed together, but clash more than click, so kickstarting a partnership is easier said than done. But with Baker’s bike skills combined with Ponch’s street savvy it might just work…if they don’t drive each other crazy along the way."}, "im:price":{"label":"$14.99", "attributes":{"amount":"14.99000", "currency":"USD"}}, "im:contentType":{"attributes":{"term":"Movie", "label":"Movie"}}, "rights":{"label":"© 2017 Warner Bros. Entertainment Inc. and Ratpac-Dune Entertainment LLC"}, "title":{"label":"CHiPs (2017) - Dax Shepard"}, "link":[
            {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/us/movie/chips-2017/id1216914823?uo=2"}},
            {"im:duration":{"label":"144992.0"}, "attributes":{"title":"Preview", "rel":"enclosure", "type":"video/x-m4v", "href":"http://video.itunes.apple.com/apple-assets-us-std-000001/Video122/v4/17/76/a1/1776a13e-a6dd-f546-f207-a9fcce111ea6/mzvf_3299193105381534482.640x458.h264lc.U.p.m4v", "im:assetType":"preview"}}], "id":{"label":"https://itunes.apple.com/us/movie/chips-2017/id1216914823?uo=2", "attributes":{"im:id":"1216914823"}}, "im:artist":{"label":"Dax Shepard"}, "category":{"attributes":{"im:id":"4404", "term":"Comedy", "scheme":"https://itunes.apple.com/us/genre/movies-comedy/id4404?uo=2", "label":"Comedy"}}, "im:releaseDate":{"label":"2017-03-24T00:00:00-07:00", "attributes":{"label":"March 24, 2017"}}}], "updated":{"label":"2017-06-20T00:46:45-07:00"}, "rights":{"label":"Copyright 2008 Apple Inc."}, "title":{"label":"iTunes Store: Top Movies"}, "icon":{"label":"http://itunes.apple.com/favicon.ico"}, "link":[
        {"attributes":{"rel":"alternate", "type":"text/html", "href":"https://itunes.apple.com/WebObjects/MZStore.woa/wa/viewTop?cc=us&id=1&popId=15"}},
        {"attributes":{"rel":"self", "href":"http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/topMovies/limit=10/json"}}], "id":{"label":"http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/ws/RSS/topMovies/limit=10/json"}}};
    context('with a data containing top results', function() {
        it('formats the data as expected', function() {
            data.delay = 'false';
            expect(subject.formatAppleData(data)).to.eq('Here are the top 10 iTunes Store: Top Movies list Beauty and the Beast (2017),John Wick: Chapter 2,The LEGO Batman Movie,Hacksaw Ridge,Table 19,Logan,Saban\'s Power Rangers,Get Out,Fist Fight,CHiPs (2017) ');
        });
    });
});